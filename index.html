<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hunt-Hunt-Planur - Real-time Location Sharing</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1><img src="img/hunt-hunt-planur-48p.webp" alt="Menu" style="width: 48px; height: 48px; vertical-align: middle; margin-right: 8px;"> Hunt-Hunt-Planur</h1>
            <p class="tagline">Share your location in real-time with friends</p>
            <!-- User info section (shown when logged in) -->
            <div id="userInfo" style="display: none; margin-top: 10px;">
                <p style="color: #10b981; font-weight: bold;">
                    ğŸ‘¤ Logged in as: <span id="username"></span>
                    <button id="logoutBtn" class="btn btn-secondary" style="margin-left: 10px; padding: 5px 15px; font-size: 14px;">Logout</button>
                </p>
            </div>
        </header>

        <main class="home-content">
            <div class="hero-section">
                <h2>Welcome to Real-Time Location Sharing</h2>
                <p>Create a session and invite others to share their locations on a live map</p>
            </div>

            <div class="action-cards">
                <!-- Dashboard card (only shown when logged in) -->
                <div class="card" id="dashboardCard" style="display: none;">
                    <div class="card-icon">ğŸ“Š</div>
                    <h3>Dashboard</h3>
                    <p>Manage your sessions and create new ones</p>
                    <a href="dashboard.html" class="btn btn-primary">Go to Dashboard</a>
                </div>

                <!-- History card (only shown when logged in) -->
                <div class="card" id="historyCard" style="display: none;">
                    <div class="card-icon">ğŸ“œ</div>
                    <h3>History</h3>
                    <p>View all your past and current sessions</p>
                    <a href="history.html" class="btn btn-secondary">View History</a>
                </div>

                <!-- Login card (hidden when logged in) -->
                <div class="card" id="loginCard">
                    <div class="card-icon"><img src="img/hunt-hunt-planur-48p.webp" alt="Menu" style="vertical-align: middle; margin-right: 8px;"></div>
                    <h3>Login</h3>
                    <p>Access your account to create and manage sessions</p>
                    <a href="login.html" class="btn btn-primary">Login</a>
                </div>

                <!-- Register card (hidden when logged in) -->
                <div class="card" id="registerCard">
                    <div class="card-icon">ğŸ“</div>
                    <h3>Register</h3>
                    <p>Create a new account to get started</p>
                    <a href="register.html" class="btn btn-secondary">Register</a>
                </div>

                <div class="card">
                    <div class="card-icon">ğŸ¯</div>
                    <h3>Join Session</h3>
                    <p>Join an existing session as a guest</p>
                    <a href="join.html" class="btn btn-accent">Join as Guest</a>
                </div>
            </div>

            <div class="features">
                <div class="features-content">
                    <div class="features-text">
                        <h3>Features</h3>
                        <ul>
                            <li>âœ… Real-time location tracking</li>
                            <li>âœ… Create and share session codes</li>
                            <li>âœ… Join as registered user or guest</li>
                            <li>âœ… Interactive map visualization</li>
                            <li>âœ… Secure and private sessions</li>
                        </ul>
                    </div>
                    <div class="features-image">
                        <img src="img/hunt-hunt-planur-800p.webp" alt="Hunt-Hunt-Planur App Preview">
                    </div>
                </div>
            </div>
        </main>

        <footer>
            <p>&copy; 2026 Hunt-Hunt-Planur. Real-time location sharing made easy.</p>
        </footer>
    </div>

    <script>
        // Check authentication status on page load
        async function checkAuth() {
            try {
                const response = await fetch('/api/check_auth');
                const data = await response.json();
                
                if (data.authenticated) {
                    // User is logged in - show dashboard and history, hide login/register
                    document.getElementById('userInfo').style.display = 'block';
                    document.getElementById('username').textContent = data.username;
                    document.getElementById('dashboardCard').style.display = 'block';
                    document.getElementById('historyCard').style.display = 'block';
                    document.getElementById('loginCard').style.display = 'none';
                    document.getElementById('registerCard').style.display = 'none';
                } else {
                    // User is not logged in - show login/register, hide dashboard and history
                    document.getElementById('userInfo').style.display = 'none';
                    document.getElementById('dashboardCard').style.display = 'none';
                    document.getElementById('historyCard').style.display = 'none';
                    document.getElementById('loginCard').style.display = 'block';
                    document.getElementById('registerCard').style.display = 'block';
                }
            } catch (error) {
                console.error('Auth check error:', error);
                // On error, show login/register options
                document.getElementById('userInfo').style.display = 'none';
                document.getElementById('dashboardCard').style.display = 'none';
                document.getElementById('historyCard').style.display = 'none';
                document.getElementById('loginCard').style.display = 'block';
                document.getElementById('registerCard').style.display = 'block';
            }
        }

        // Logout functionality
        document.getElementById('logoutBtn').addEventListener('click', async () => {
            try {
                await fetch('/api/logout', { method: 'POST' });
                // Reload page to update UI
                window.location.reload();
            } catch (error) {
                console.error('Logout error:', error);
                alert('Failed to logout. Please try again.');
            }
        });

        // Check auth on page load
        checkAuth();
    </script>
    <script src="js/navigation.js"></script>
</body>
</html>
